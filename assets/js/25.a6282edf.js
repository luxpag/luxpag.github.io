(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{411:function(t,e,a){"use strict";a.r(e);var n=a(54),r=Object(n.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"获取信用卡token"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取信用卡token"}},[t._v("#")]),t._v(" 获取信用卡Token")]),t._v(" "),a("h3",{attrs:{id:"使用luxpag-javascript集成库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用luxpag-javascript集成库"}},[t._v("#")]),t._v(" 使用Luxpag JavaScript集成库")]),t._v(" "),a("p",[t._v("采用"),a("a",{attrs:{href:"api-direct"}},[t._v("直连接口下单")]),t._v("，信用卡支付，需要使用 "),a("a",{attrs:{target:"_blank",href:"https://res.luxpag.com/lib/js/luxpag.js"}},[t._v("luxpag.js 库")]),t._v("，以便获取直连接口 token 和 fingerprint 参数。")]),t._v(" "),a("h3",{attrs:{id:"集成步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集成步骤"}},[t._v("#")]),t._v(" 集成步骤")]),t._v(" "),a("h4",{attrs:{id:"_1-添加-luxpag-js-引用到您的支付页面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-添加-luxpag-js-引用到您的支付页面"}},[t._v("#")]),t._v(" 1. 添加 luxpag.js 引用到您的支付页面")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("不建议将此luxpag.js本地缓存")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('<script src="https://res.luxpag.com/lib/js/luxpag.js"><\/script>\n')])])]),a("h4",{attrs:{id:"_2-获取-app-id-和-public-key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-获取-app-id-和-public-key"}},[t._v("#")]),t._v(" 2. 获取 APP ID 和 Public Key")]),t._v(" "),a("p",[t._v("在Luxpag商户后台APP List管理页面找到APP，点击查看详情，找到APP ID 和 Public Key，给Luxpag.setPublishableKey赋值。\nprod：生产环境，sandbox：测试环境")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("<script>\n  Luxpag.setPublishableKey('${app_id}','${public_key}','sandbox | prod')\n<\/script>\n")])])]),a("h4",{attrs:{id:"_3-创建-luxpag专用表单组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-创建-luxpag专用表单组件"}},[t._v("#")]),t._v(" 3. 创建 luxpag专用表单组件")]),t._v(" "),a("p",[t._v("保证现有表单中存在如下字段，并按格式添加data-checkout属性。")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("参数名")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("必须")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("luxpagCardNumber")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("yes")]),t._v(" "),a("td",[t._v("信用卡卡号")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("luxpagSecurityCode")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("yes")]),t._v(" "),a("td",[t._v("安全码CVV")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("luxpagCardExpirationYear")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("yes")]),t._v(" "),a("td",[t._v("过期年（四位）")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("luxpagCardExpirationMonth")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("yes")]),t._v(" "),a("td",[t._v("过期月（两位）")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("luxpagCardholderName")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("yes")]),t._v(" "),a("td",[t._v("持卡人姓名")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("luxpagDocType")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("no")]),t._v(" "),a("td",[t._v("持卡人ID类型")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("luxpagDocNumber")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("no")]),t._v(" "),a("td",[t._v("持卡人ID")])])])]),t._v(" "),a("p",[t._v("例如：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('<form method="post" id="pay">\n    <ul>\n        <li>\n            <label for="cardNumber">Credit card number:</label>\n            <input type="text" data-checkout="luxpagCardNumber" maxlength="16" />\n        </li>\n        <li>\n            <label for="securityCode">Security code(cvv):</label>\n            <input type="text" data-checkout="luxpagSecurityCode" maxlength="4" />\n        </li>\n        <li>\n            <label for="cardExpirationYear">Expiration year:</label>\n            <input type="text" data-checkout="luxpagCardExpirationYear" placeholder="2021" />\n        </li>\n        <li>\n            <label for="cardExpirationMonth">Expiration month:</label>\n            <input type="text" data-checkout="luxpagCardExpirationMonth" maxlength="2" />\n        </li>\n        <li>\n            <label for="cardholderName">Card holder name:</label>\n            <input type="text" data-checkout="luxpagCardholderName"  />\n        </li>\n        <li>\n            <label for="docType">Document type:</label>\n            <select data-checkout="luxpagDocType">\n\t            <option value="CPF">CPF</option>\n            </select>\n        </li>\n        <li>\n            <label for="docNumber">Document number:</label>\n            <input type="text" data-checkout="luxpagDocNumber" placeholder="12345678" />\n        </li>\n    </ul>\n    \x3c!-- 存放token值的隐藏域 --\x3e\n    <input name="token" id="luxpagToken" type="hidden">\n    \x3c!-- 存放fingerprint值的隐藏域 --\x3e\n    <input name="fingerprint" id="luxpagFingerprint" type="hidden">\n    <input type="submit" value="Pay!" />\n</form>\n')])])]),a("p",[t._v("其中两个隐藏域")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('\x3c!-- 存放token值的隐藏域 --\x3e\n<input name="token" id="luxpagToken" type="hidden">\n\x3c!-- 存放fingerprint值的隐藏域 --\x3e\n<input name="fingerprint" id="luxpagFingerprint" type="hidden">\n')])])]),a("h4",{attrs:{id:"_4-监听form提交事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-监听form提交事件"}},[t._v("#")]),t._v(" 4.监听form提交事件")]),t._v(" "),a("p",[t._v("网站原有提交事件前调用：Luxpag.createToken函数，传入form表单元素并更新上面两个隐藏域。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("var $form = document.querySelector('#pay')\nLuxpag.createToken($form, responseHandler)\n")])])]),a("p",[t._v("例如：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('document.querySelector("#pay").addEventListener("submit",function(e){\n        e.preventDefault() \n        var $form = document.querySelector(\'#pay\')\n        Luxpag.createToken($form, responseHandler)\n    })\n\n    function responseHandler(res){\n        if(res.status != 200){\n            // create token fail\n            alert(res.message)\n        }else{\n            // create token success\n            alert(res.message+" token="+document.querySelector("#luxpagToken").value\n            +"; fingerprint="+document.querySelector("#luxpagFingerprint").value)\n        }\n    }\n')])])])])}),[],!1,null,null,null);e.default=r.exports}}]);